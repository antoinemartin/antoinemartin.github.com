<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Debugging a failing OpenStack image - mrtn.me</title><meta name=Description content="How to debug locally on a windows machine an Openstack image
"><meta property="og:title" content="Debugging a failing OpenStack image"><meta property="og:description" content="How to debug locally on a windows machine an Openstack image
"><meta property="og:type" content="article"><meta property="og:url" content="http://mrtn.me/posts/2023/01/13/debugging-a-failing-openstack-image/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-13T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-13T18:21:21+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Debugging a failing OpenStack image"><meta name=twitter:description content="How to debug locally on a windows machine an Openstack image
"><meta name=application-name content="mrtn.me"><meta name=apple-mobile-web-app-title content="mrtn.me"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://mrtn.me/posts/2023/01/13/debugging-a-failing-openstack-image/><link rel=prev href=http://mrtn.me/posts/2022/05/11/multiple-docker-environments-on-windows/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Debugging a failing OpenStack image","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/mrtn.me\/posts\/2023\/01\/13\/debugging-a-failing-openstack-image\/"},"genre":"posts","keywords":"Openstack, cloud-init, hyper-v, wsl, windows","wordcount":888,"url":"http:\/\/mrtn.me\/posts\/2023\/01\/13\/debugging-a-failing-openstack-image\/","datePublished":"2023-01-13T00:00:00+00:00","dateModified":"2023-01-13T18:21:21+01:00","publisher":{"@type":"Organization","name":"Antoine Martin"},"author":{"@type":"Person","name":"Antoine Martin"},"description":"How to debug locally on a windows machine an Openstack image\n"}</script></head><body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=mrtn.me>mrtn.me</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/ title="Blog posts">Posts </a><a class=menu-item href=/about/ title="About me">About </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=https://github.com/antoinemartin title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=mrtn.me>mrtn.me</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title="Blog posts">Posts</a><a class=menu-item href=/about/ title="About me">About</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=https://github.com/antoinemartin title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Debugging a failing OpenStack image</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://linked.in/in/antoinemartin title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>Antoine Martin</a></span>&nbsp;<span class=post-category>included in <a href=/categories/devops/><i class="far fa-folder fa-fw"></i>Devops</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=13-01>13-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;888 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;5 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#the-problem>The problem</a></li><li><a href=#the-objective>The objective</a></li><li><a href=#the-tools>The tools</a></li><li><a href=#the-steps>The steps</a><ul><li><a href=#image-conversion>Image conversion</a></li><li><a href=#mounting-the-image>Mounting the image</a></li><li><a href=#chrooting-inside-the-image>Chrooting inside the image</a></li><li><a href=#allowing-access-to-the-image>Allowing access to the image</a></li><li><a href=#unmounting-the-image>Unmounting the image</a></li><li><a href=#creating-the-hyper-v-vm>Creating the Hyper-V VM</a></li></ul></li><li><a href=#final-thoughts>Final thoughts</a></li></ul></nav></div></div><div class=content id=content><h2 id=the-problem>The problem</h2><p>On my
<a href=https://github.com/antoinemartin/alpine-openstack-vm target=_blank rel="noopener noreffer">alpine-openstack-vm</a>
project, There is a CI process producing a VM image for OpenStack. The process
involves testing that the machine boots. <a href=https://github.com/antoinemartin/alpine-openstack-vm/actions/runs/3909412713 target=_blank rel="noopener noreffer">The test
fails</a>,
but the machine is actually booted. What doesn’t work is the ssh access. As
the machine can only be reached via SSH with a private key for obvious security
reasons, not having access prevents proper debug.</p><h2 id=the-objective>The objective</h2><p>The objective is to be able to run the produced VM locally to assess the issue.
As the image in its current form doesn’t work, the VM image needs to be
slightly modified in order to allow access. If the VM is run locally, adding a
root password should be sufficient.</p><h2 id=the-tools>The tools</h2><ul><li>Windows 11</li><li>Hyper-V. Information on installation is
<a href=https://learn.microsoft.com/en-us/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v target=_blank rel="noopener noreffer">here</a>.
If you are using WSL, you should already be set up or really close.</li><li>PowerShell.</li><li>A Windows Subsystem for Linux (WSL) distribution with <code>qemu-img</code> installed.
You can set it up faster with
<a href=https://mrtn.me/PowerShell-Wsl-Manager/ target=_blank rel="noopener noreffer">Powershell-WSL-Manager</a>.</li></ul><p>We need to download your Openstack image locally. Hopefully, it is kept as an
artifact of <a href=https://github.com/antoinemartin/alpine-openstack-vm/actions/runs/3909412713 target=_blank rel="noopener noreffer">our
build</a>.</p><h2 id=the-steps>The steps</h2><h3 id=image-conversion>Image conversion</h3><p>We are going to convert the image from the <code>qcow2</code> format to the <code>vhdx</code> in order
to be able to use it as the base disk of an Hyper-V VM. This will also allow us
to mount it inside a WSL distribution to modify it.</p><p>This is done with the <code>qemu-img</code> command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>❯ qemu-img convert alpine-openstack.qcow2 -O vhdx -o <span class=nv>subformat</span><span class=o>=</span>dynamic alpine-openstack.vhdx
</span></span></code></pre></td></tr></table></div></div><h3 id=mounting-the-image>Mounting the image</h3><p>Now we can mount the image in WSL:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>❯ wsl.exe --mount --vhd alpine-openstack.vhdx
</span></span><span class=line><span class=cl>Le disque a été monté en tant que « /mnt/wsl/CUsersAntoineMartinDownloadsalpineopenstackvhdx ».
</span></span><span class=line><span class=cl>Remarque : l’emplacement sera différent si vous avez modifié le paramètre automount.root dans /etc/wsl.conf.
</span></span><span class=line><span class=cl>Pour démonter et détacher le disque, exécutez « wsl.exe --unmount <span class=se>\\</span>?<span class=se>\C</span>:<span class=se>\U</span>sers<span class=se>\A</span>ntoineMartin<span class=se>\D</span>ownloads<span class=se>\a</span>lpine-openstack.vhdx ».
</span></span><span class=line><span class=cl>❯
</span></span></code></pre></td></tr></table></div></div><h3 id=chrooting-inside-the-image>Chrooting inside the image</h3><p>We can now chroot inside the image to modify it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>❯ chroot /mnt/wsl/CUsersAntoineMartinDownloadsalpineopenstackvhdx
</span></span><span class=line><span class=cl>➜  /
</span></span></code></pre></td></tr></table></div></div><h3 id=allowing-access-to-the-image>Allowing access to the image</h3><p>We set a root password in order to be able to login in our VM:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>➜  ~ passwd
</span></span><span class=line><span class=cl>New password:
</span></span><span class=line><span class=cl>Retype new password:
</span></span><span class=line><span class=cl>passwd: password updated successfully
</span></span><span class=line><span class=cl>➜  ~
</span></span></code></pre></td></tr></table></div></div><p>in <code>/etc/ssh/sshd_config</code>, we enable root login and password authentication:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># To disable tunneled clear text passwords, change to no here!</span>
</span></span><span class=line><span class=cl>PasswordAuthentication yes
</span></span><span class=line><span class=cl>PermitRootLogin yes
</span></span></code></pre></td></tr></table></div></div><p>In <code>/etc/cloud/cloud.cfg</code>, we allow ssh password authentication:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>ssh_pwauth</span><span class=p>:</span><span class=w>   </span><span class=kc>true</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>At this point, you can also add a <code>/root/.ssh/authorized_keys</code> file containing a
public key for ssh authenticiation.</p><p>Then you can exit the chroot with the <code>exit</code> command.</p><h3 id=unmounting-the-image>Unmounting the image</h3><p>From windows, type:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=n>wsl</span> <span class=p>-</span><span class=n>-unmount</span>  <span class=nb>alpine-openstack</span><span class=p>.</span><span class=py>vhdx</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=creating-the-hyper-v-vm>Creating the Hyper-V VM</h3><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fas fa-exclamation-triangle fa-fw"></i>Warning<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content><p>To be able to create Hyper-V VMs from the command line, your user needs to be part of the <code>Hyper-V Administrators</code> group. You can add your user to this group with the command line:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=c># In a `Run as Administrator` terminal (consider sudo from scoop)</span>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=n>net</span> <span class=n>localgroup</span> <span class=s2>&#34;Hyper-V Administrators&#34;</span> <span class=p>&lt;</span><span class=n>UserName</span><span class=p>&gt;</span> <span class=p>/</span><span class=n>add</span>
</span></span></code></pre></td></tr></table></div></div><p>Unfortunately, you will also need to restart your machine 😞</p></div></div></div><p>Create and start the VM from the command line:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># Isolating the VM</span>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=n>mkdir</span> <span class=n>debug</span>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nb>mv alpine-openstack</span><span class=p>.</span><span class=py>vhdx</span> <span class=n>debug</span>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nb>cd </span><span class=n>debug</span>
</span></span><span class=line><span class=cl><span class=c># Creating the VM</span>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nb>New-VM</span> <span class=n>-Name</span> <span class=n>debug</span> <span class=n>-MemoryStartupBytes</span> <span class=mf>2</span><span class=p>GB</span> <span class=n>-Path</span> <span class=p>.</span> <span class=n>-BootDevice</span> <span class=n>VHD</span> <span class=n>-VHDPath</span> <span class=p>.\</span><span class=nb>alpine-openstack</span><span class=p>.</span><span class=py>vhdx</span> <span class=n>-SwitchName</span> <span class=s2>&#34;Default Switch&#34;</span> <span class=n>-Generation</span> <span class=mf>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Name</span>  <span class=n>State</span> <span class=n>CPUUsage</span><span class=p>(%)</span> <span class=n>MemoryAssigned</span><span class=p>(</span><span class=n>M</span><span class=p>)</span> <span class=n>Uptime</span>   <span class=n>Status</span>                <span class=n>Version</span>
</span></span><span class=line><span class=cl><span class=p>----</span>  <span class=p>-----</span> <span class=p>-----------</span> <span class=p>-----------------</span> <span class=p>------</span>   <span class=p>------</span>                <span class=p>-------</span>
</span></span><span class=line><span class=cl><span class=n>debug</span> <span class=n>Off</span>   <span class=mf>0</span>           <span class=mf>0</span>                 <span class=mf>00</span><span class=err>:</span><span class=mf>00</span><span class=err>:</span><span class=mf>00</span> <span class=n>Fonctionnement</span> <span class=n>normal</span> <span class=mf>11.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nb>Start-VM</span> <span class=n>-Name</span> <span class=n>debug</span>
</span></span></code></pre></td></tr></table></div></div><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw"></i>Tip<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>We use <code>-Generation 1</code> here in order to avoid UEFI initialization.</div></div></div><p>Now you can connect to the VM:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=n>vmconnect</span> <span class=n>localhost</span> <span class=n>debug</span>
</span></span></code></pre></td></tr></table></div></div><p>And you should be able to see the VM window:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/57d67816-b3f8-491d-b681-aa56e4be79f1.png data-srcset="/images/57d67816-b3f8-491d-b681-aa56e4be79f1.png, /images/57d67816-b3f8-491d-b681-aa56e4be79f1.png 1.5x, /images/57d67816-b3f8-491d-b681-aa56e4be79f1.png 2x" data-sizes=auto alt=/images/57d67816-b3f8-491d-b681-aa56e4be79f1.png title=image></p><p>The actual issue appears clearly in the image above. You should be able to
connect as root with the password you entered before:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/images/f3769ee0-7eba-4322-aef9-9cab9d0b0001.png data-srcset="/images/f3769ee0-7eba-4322-aef9-9cab9d0b0001.png, /images/f3769ee0-7eba-4322-aef9-9cab9d0b0001.png 1.5x, /images/f3769ee0-7eba-4322-aef9-9cab9d0b0001.png 2x" data-sizes=auto alt=/images/f3769ee0-7eba-4322-aef9-9cab9d0b0001.png title=image></p><p>And look at the issues that created the error.</p><p>You can also connect with ssh. To find the IP address of the machine, you can
type the following command on Powershell:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nb>Get-NetNeighbor</span> <span class=n>-LinkLayerAddress</span> <span class=mf>00</span><span class=p>-</span><span class=mf>15</span><span class=p>-</span><span class=mf>5d</span><span class=p>-*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ifIndex</span> <span class=n>IPAddress</span>                                          <span class=n>LinkLayerAddress</span>      <span class=n>State</span>       <span class=n>PolicyStore</span>
</span></span><span class=line><span class=cl><span class=p>-------</span> <span class=p>---------</span>                                          <span class=p>----------------</span>      <span class=p>-----</span>       <span class=p>-----------</span>
</span></span><span class=line><span class=cl><span class=mf>60</span>      <span class=mf>172.26</span><span class=p>.</span><span class=py>137</span><span class=p>.</span><span class=py>156</span>                                     <span class=mf>00</span><span class=p>-</span><span class=mf>15</span><span class=p>-</span><span class=mf>5D</span><span class=p>-</span><span class=mf>25</span><span class=p>-</span><span class=mf>05</span><span class=p>-</span><span class=mf>1D</span>     <span class=n>Reachable</span>   <span class=n>ActiveStore</span>
</span></span><span class=line><span class=cl><span class=mf>29</span>      <span class=mf>172.20</span><span class=p>.</span><span class=py>68</span><span class=p>.</span><span class=py>230</span>                                      <span class=mf>00</span><span class=p>-</span><span class=mf>15</span><span class=p>-</span><span class=mf>5D</span><span class=p>-</span><span class=mf>00</span><span class=p>-</span><span class=mf>3F</span><span class=p>-</span><span class=mf>24</span>     <span class=n>Permanent</span>   <span class=n>ActiveStore</span>
</span></span></code></pre></td></tr></table></div></div><p>Here the address of the machine would be the second one, the one marked with
Permanet. You can connect to it:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=n>ssh</span> <span class=n>root</span><span class=nv>@172</span><span class=p>.</span><span class=py>20</span><span class=p>.</span><span class=py>68</span><span class=p>.</span><span class=py>230</span>
</span></span><span class=line><span class=cl><span class=n>Warning</span><span class=err>:</span> <span class=n>Permanently</span> <span class=n>added</span> <span class=s1>&#39;172.20.68.230&#39;</span> <span class=p>(</span><span class=n>ED25519</span><span class=p>)</span> <span class=n>to</span> <span class=n>the</span> <span class=n>list</span> <span class=n>of</span> <span class=n>known</span> <span class=n>hosts</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=n>root</span><span class=nv>@172</span><span class=p>.</span><span class=py>20</span><span class=p>.</span><span class=py>68</span><span class=p>.</span><span class=mf>230</span><span class=err>&#39;</span><span class=n>s</span> <span class=n>password</span><span class=err>:</span>
</span></span><span class=line><span class=cl><span class=n>Welcome</span> <span class=n>to</span> <span class=n>Alpine</span><span class=p>!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>The</span> <span class=n>Alpine</span> <span class=n>Wiki</span> <span class=n>contains</span> <span class=n>a</span> <span class=n>large</span> <span class=n>amount</span> <span class=n>of</span> <span class=nb>how-to</span> <span class=n>guides</span> <span class=n>and</span> <span class=n>general</span>
</span></span><span class=line><span class=cl><span class=n>information</span> <span class=n>about</span> <span class=n>administrating</span> <span class=n>Alpine</span> <span class=n>systems</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=n>See</span> <span class=p>&lt;</span><span class=n>https</span><span class=err>:</span><span class=p>//</span><span class=n>wiki</span><span class=p>.</span><span class=py>alpinelinux</span><span class=p>.</span><span class=n>org</span><span class=p>/&gt;.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>You</span> <span class=n>can</span> <span class=n>setup</span> <span class=n>the</span> <span class=n>system</span> <span class=n>with</span> <span class=n>the</span> <span class=n>command</span><span class=err>:</span> <span class=nb>setup-alpine</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>You</span> <span class=n>may</span> <span class=n>change</span> <span class=n>this</span> <span class=n>message</span> <span class=n>by</span> <span class=n>editing</span> <span class=p>/</span><span class=n>etc</span><span class=p>/</span><span class=n>motd</span><span class=p>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>➜</span>  <span class=p>~</span>
</span></span></code></pre></td></tr></table></div></div><p>On the terminal window as well as with ssh, you are now able to find the issue
with your image.</p><p>Once the reason of the issue is found, you can delete the VM:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nb>Stop-VM</span> <span class=n>debug</span>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span> <span class=nb>Remove-VM</span> <span class=n>debug</span> <span class=n>-Force</span>
</span></span><span class=line><span class=cl><span class=n>PS</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=final-thoughts>Final thoughts</h2><p>The above procedure is interesting not only for debugging non working images but
also to run any image as long as the image format can be handled by qemu. Having
WSL at hand is also handy to mount and hack the image.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 13-01&nbsp;<a class=git-hash href=https://github.com/antoinemartin/antoinemartin.github.io/commit/aa655f55bc2bd84af0b478905aeecf9453ad15cb target=_blank title="commit by Antoine Martin(antoine@mrtn.fr) aa655f55bc2bd84af0b478905aeecf9453ad15cb: 📝 New blog post">
<i class="fas fa-hashtag fa-fw"></i>aa655f5</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/openstack/>Openstack</a>,&nbsp;<a href=/tags/cloud-init/>cloud-init</a>,&nbsp;<a href=/tags/hyper-v/>hyper-v</a>,&nbsp;<a href=/tags/wsl/>wsl</a>,&nbsp;<a href=/tags/windows/>windows</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/2022/05/11/multiple-docker-environments-on-windows/ class=prev rel=prev title="Multiple Docker environments on Windows"><i class="fas fa-angle-left fa-fw"></i>Multiple Docker environments on Windows</a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.109.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2012 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://linked.in/in/antoinemartin target=_blank>Antoine Martin</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=https://geekquickies.disqus.com/embed.js defer></script><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:30},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-29953512-1")</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-29953512-1" async></script></body></html>